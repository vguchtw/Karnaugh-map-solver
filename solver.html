
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Karnaugh Map Solver — Standalone Demo</title>
  <meta name="description" content="Interactive Karnaugh Map (K‑map) solver with 2–6 variables, Gray code mapping, and Quine–McCluskey simplification.">
  <meta name="robots" content="index,follow">

  <style>
    :root{
      --bg: #0f172a;
      --panel: #111827;
      --card: #ffffff;
      --text: #0b1220;
      --accent: #2563eb;
      --muted: #6b7280;
      --ring: rgba(37, 99, 235, .35);
    }
    @media (prefers-color-scheme: dark) {
      :root{
        --bg: #0b1220;
        --panel: #0f172a;
        --card: #111827;
        --text: #e5e7eb;
        --accent: #60a5fa;
        --muted: #9ca3af;
        --ring: rgba(96, 165, 250, .35);
      }
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 10% -10%, rgba(96,165,250,.08), transparent 60%),
                  radial-gradient(1200px 600px at 110% 10%, rgba(34,197,94,.06), transparent 60%),
                  var(--bg);
      color: var(--text);
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    .wrap{ max-width: 1100px; margin: 0 auto; padding: 24px; }

    header.site{
      display:flex; align-items:center; justify-content:space-between;
      gap: 12px; padding: 14px 0 22px;
    }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{
      width:38px; height:38px; border-radius:10px;
      display:grid; place-items:center;
      background: linear-gradient(135deg, rgba(37,99,235,.25), rgba(99,102,241,.25));
      border: 1px solid rgba(148,163,184,.2);
      box-shadow: 0 6px 30px rgba(37,99,235,.15), inset 0 0 0 1px rgba(255,255,255,.05);
      color:#fff; font-weight:800;
    }

    .title{
      font-size: clamp(20px, 2.5vw, 28px);
      font-weight: 800; letter-spacing:.2px;
      color: var(--muted);
    }
    .subtitle{
      color: var(--muted);
      font-size: 14px;
      margin-top: 2px;
    }

    .hero{
      margin: 6px 0 20px;
      padding: 18px 18px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
      border: 1px solid rgba(148,163,184,.25);
    }
    .hero p{ margin: 0.4rem 0; color: var(--muted) }

    .card{
      background: var(--card);
      color: var(--text);
      border-radius: 14px;
      padding: 18px;
      border: 1px solid rgba(148,163,184,.35);
      box-shadow: 0 20px 60px rgba(2,6,23,.25);
    }

    .note{ font-size: 13px; color: var(--muted); margin-top: 8px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="site">
      <div class="brand">
        <div class="logo">K</div>
        <div>
          <div class="title">Karnaugh Map Solver</div>
        </div>
      </div>
    </header>

    <section class="hero card">
      <p>Click cells to toggle 0/1. Use the selector to choose the number of variables (2–8). The simplified expression updates instantly.</p>
    </section>

    <section class="card" aria-label="Karnaugh Map Solver">
      <div class="karnaugh-solver">
        <style>
          .karnaugh-solver { font-family: Arial, sans-serif; margin: 20px; }
          .karnaugh-solver .instructions { font-size: 16px; margin-bottom: 20px; }
          .karnaugh-solver .settings { margin-bottom: 20px; text-align: center; }
          .karnaugh-solver .settings select { font-size: 16px; padding: 5px; width: auto; max-width: 220px; }
          .karnaugh-solver table { width: 100%; max-width: 600px; margin: 0 auto; border-collapse: collapse; }
          .karnaugh-solver td {
            width: 40px; height: 40px; text-align: center; vertical-align: middle;
            border: 1px solid #333; font-size: 18px; user-select: none; cursor: pointer;
          }
          .karnaugh-solver td.active { background-color: #aaf; }
          .karnaugh-solver .result-area { text-align: center; font-weight: bold; margin-top: 20px; }
          .karnaugh-solver .mobile-fallback {
            display: none; padding: 20px; background: #fee; text-align: center; font-size: 16px; border: 1px solid #f00;
          }
          @media (max-width: 767px) {
            .karnaugh-solver > *:not(.mobile-fallback) { display: none; }
            .karnaugh-solver .mobile-fallback { display: block; }
          }
        </style>

        <div class="instructions">
          Tap a cell to toggle between 0 and 1; the simplified expression updates automatically.
        </div>

        <div class="settings">
          <label for="var-count">Number of variables: </label>
          <select id="var-count">
            <option value="2">2×2</option>
            <option value="3">2×4</option>
            <option value="4" selected>4×4</option>
            <option value="5">4×8</option>
            <option value="6">8×8</option>
          </select>
          &nbsp;&nbsp;&nbsp;
          <label for="form-select">Boolean form: </label>
          <select id="form-select">
            <option value="sop" selected>Sum of Products (SOP)</option>
            <option value="pos">Product of Sums (POS)</option>
          </select>
          &nbsp;&nbsp;&nbsp;
          <label for="output-select">Output: </label>
          <select id="output-select">
            <option value="text" selected>Text expression</option>
            <option value="gate">Logic gate diagram</option>
            <option value="python">Python pseudocode</option>
          </select>
        </div>

        <div id="kmap-container"></div>

        <div class="result-area" id="result">Simplified expression will appear here.</div>

        <div class="mobile-fallback">
          This Karnaugh Map Solver requires a screen at least 768px wide. Please switch to a larger device or rotate your screen.
        </div>

        <script>
          (function(){
            let numVars = 4;
            let kmap = [];
            let rowCodes = [];
            let colCodes = [];
            const VARS = ['A','B','C','D','E','F'];
            let selectedForm = 'sop';
            let selectedOutput = 'text';

            function grayCode(n) {
              if (n === 0) return [''];
              const prev = grayCode(n - 1);
              return prev.map(c => '0' + c).concat(prev.slice().reverse().map(c => '1' + c));
            }

            function generateMap() {
              const rows = Math.pow(2, Math.floor(numVars / 2));
              const cols = Math.pow(2, Math.ceil(numVars / 2));
              rowCodes = grayCode(Math.floor(numVars / 2));
              colCodes = grayCode(Math.ceil(numVars / 2));

              kmap = Array.from({ length: rows }, () => Array(cols).fill(0));
              const table = document.createElement('table');
              for (let r = 0; r < rows; r++) {
                const tr = document.createElement('tr');
                for (let c = 0; c < cols; c++) {
                  const td = document.createElement('td');
                  td.textContent = '0';
                  td.addEventListener('click', () => {
                    kmap[r][c] ^= 1;
                    td.textContent = kmap[r][c];
                    td.classList.toggle('active', kmap[r][c] === 1);
                    solve();
                  });
                  tr.appendChild(td);
                }
                table.appendChild(tr);
              }
              const container = document.getElementById('kmap-container');
              container.innerHTML = '';
              container.appendChild(table);
            }

            function getBinary(num, len) {
              let s = num.toString(2);
              return '0'.repeat(len - s.length) + s;
            }
            function combineTerms(a, b) {
              let diff = 0, out = '';
              for (let i = 0; i < a.length; i++) {
                if (a[i] === b[i]) out += a[i];
                else { if (a[i] === '-' || b[i] === '-') return null; diff++; out += '-'; }
              }
              return diff === 1 ? out : null;
            }
            function findPrimeImplicants(minterms, vars) {
              let terms = minterms.map(m => ({ term: getBinary(m, vars), minterms: [m], used: false }));
              let primes = [];
              while (terms.length) {
                const next = [];
                terms.forEach((t, i) => terms.slice(i+1).forEach(u => {
                  const c = combineTerms(t.term, u.term);
                  if (c) {
                    t.used = u.used = true;
                    if (!next.some(x => x.term === c)) next.push({ term: c, minterms: [...new Set([...t.minterms, ...u.minterms])], used: false });
                  }
                }));
                terms.forEach(t => { if (!t.used) primes.push(t); });
                terms = next;
              }
              return primes;
            }
            function selectPrimeImplicants(primes, minterms) {
              const chart = {};
              minterms.forEach(m => chart[m] = primes.reduce((arr,p,i) => p.minterms.includes(m) ? arr.concat(i) : arr, []));
              const essential = new Set(Object.values(chart).filter(c => c.length === 1).map(c => c[0]));
              let covered = new Set(); essential.forEach(i => primes[i].minterms.forEach(m => covered.add(m)));
              let selected = [...essential]; let rem = minterms.filter(m => !covered.has(m));
              while (rem.length) {
                let best = -1, bestCount = 0;
                primes.forEach((p,i) => {
                  if (selected.includes(i)) return;
                  const count = p.minterms.filter(m => rem.includes(m)).length;
                  if (count > bestCount) { bestCount = count; best = i; }
                });
                if (best < 0) break;
                selected.push(best);
                primes[best].minterms.forEach(m => covered.add(m));
                rem = minterms.filter(m => !covered.has(m));
              }
              return selected.map(i => primes[i]);
            }
            function termToExpr(term) {
              return term.split('').map((b,i) => b === '1' ? VARS[i] : b === '0' ? VARS[i] + "'" : '').join('') || '1';
            }
            function getOnesIndices() {
              const ones = [];
              for (let r = 0; r < rowCodes.length; r++) {
                for (let c = 0; c < colCodes.length; c++) {
                  if (kmap[r][c]) {
                    const bits = rowCodes[r] + colCodes[c];
                    ones.push(parseInt(bits, 2));
                  }
                }
              }
              return ones;
            }
            function getZerosIndices(total) {
              const ones = new Set(getOnesIndices());
              const zeros = [];
              for (let i = 0; i < total; i++) if (!ones.has(i)) zeros.push(i);
              return zeros;
            }
            function patternToLiterals(pattern, mode) {
              const literals = [];
              for (let i = 0; i < pattern.length; i++) {
                const bit = pattern[i];
                if (bit === '-') continue;
                if (mode === 'sop') {
                  literals.push({ var: VARS[i], negated: bit === '0' });
                } else {
                  literals.push({ var: VARS[i], negated: bit === '1' });
                }
              }
              return literals;
            }
            function literalsToText(literals, mode) {
              if (mode === 'sop') {
                return literals.map(l => l.var + (l.negated ? "'" : '')).join('') || '1';
              }
              return '(' + (literals.map(l => l.var + (l.negated ? "'" : '')).join(' + ') || '1') + ')';
            }
            function generatePythonCode(clauses, mode) {
              const args = VARS.slice(0, numVars).join(', ');
              let body;
              if (clauses === 'CONST_0') {
                body = 'return False';
              } else if (clauses === 'CONST_1') {
                body = 'return True';
              } else if (mode === 'sop') {
                const parts = clauses.map(group => group.map(l => (l.negated ? 'not ' : '') + l.var).join(' and '));
                body = 'return ' + (parts.length ? '(' + parts.join(') or (') + ')' : 'False');
              } else {
                const parts = clauses.map(group => group.map(l => (l.negated ? 'not ' : '') + l.var).join(' or '));
                body = 'return ' + (parts.length ? '(' + parts.map(p => '(' + p + ')').join(' and ') + ')' : 'True');
              }
              return 'def F(' + args + '):\n    ' + body + '\n';
            }
            function renderGateDiagram(clauses, mode, exprStr) {
              const resultEl = document.getElementById('result');
              if (clauses === 'CONST_0' || clauses === 'CONST_1') {
                resultEl.textContent = 'Simplified Expression: ' + (clauses === 'CONST_1' ? '1' : '0');
                return;
              }
              const varCount = numVars;
              const usedVars = VARS.slice(0, varCount);
              const width = 760;
              const varGapY = 28;
              const varStartY = 30;
              const varYs = usedVars.map((_, i) => varStartY + i * varGapY);
              const stageGapY = 70;
              const gateYs = clauses.map((_, i) => 60 + i * stageGapY);
              const height = Math.max(varYs[varYs.length - 1] + 60, (clauses.length - 1) * stageGapY + 140);
              const inputLineX1 = 50, inputLineX2 = 210;
              const gateX = 280;
              const aggregatorX = 480;
              const outputX = 720;
              const gateLabel = mode === 'sop' ? 'AND' : 'OR';
              const aggregatorLabel = mode === 'sop' ? 'OR' : 'AND';
              let svg = '<svg xmlns="http://www.w3.org/2000/svg" width="' + width + '" height="' + height + '" viewBox="0 0 ' + width + ' ' + height + '" style="max-width:100%;">';
              svg += '<rect x="0" y="0" width="' + width + '" height="' + height + '" fill="transparent"/>';
              usedVars.forEach((v, i) => {
                const y = varYs[i];
                svg += '<text x="18" y="' + (y + 4) + '" font-size="12" fill="currentColor">' + v + '</text>';
                svg += '<line x1="' + inputLineX1 + '" y1="' + y + '" x2="' + inputLineX2 + '" y2="' + y + '" stroke="currentColor" stroke-width="2"/>';
              });
              clauses.forEach((group, gi) => {
                const y = gateYs[gi];
                svg += '<rect x="' + (gateX - 22) + '" y="' + (y - 16) + '" width="44" height="32" rx="6" ry="6" fill="none" stroke="currentColor" stroke-width="2"/>';
                svg += '<text x="' + (gateX - 16) + '" y="' + (y + 4) + '" font-size="10" fill="currentColor">' + gateLabel + '</text>';
                svg += '<line x1="' + (gateX + 22) + '" y1="' + y + '" x2="' + (aggregatorX - 22) + '" y2="' + y + '" stroke="currentColor" stroke-width="2"/>';
                group.forEach(lit => {
                  const idx = usedVars.indexOf(lit.var);
                  const vy = varYs[idx];
                  svg += '<line x1="' + inputLineX2 + '" y1="' + vy + '" x2="' + (gateX - 22) + '" y2="' + y + '" stroke="currentColor" stroke-width="1.5"/>';
                  if (lit.negated) {
                    svg += '<circle cx="' + (gateX - 28) + '" cy="' + (y + (vy - y) * 0.5) + '" r="4" fill="white" stroke="currentColor" stroke-width="1.5"/>';
                  }
                });
              });
              const aggY = clauses.length ? gateYs[Math.floor((clauses.length - 1) / 2)] : 60;
              svg += '<rect x="' + (aggregatorX - 22) + '" y="' + (aggY - 16) + '" width="44" height="32" rx="6" ry="6" fill="none" stroke="currentColor" stroke-width="2"/>';
              svg += '<text x="' + (aggregatorX - 17) + '" y="' + (aggY + 4) + '" font-size="10" fill="currentColor">' + aggregatorLabel + '</text>';
              clauses.forEach((_, gi) => {
                const y = gateYs[gi];
                svg += '<line x1="' + (aggregatorX - 22) + '" y1="' + y + '" x2="' + (aggregatorX - 22) + '" y2="' + aggY + '" stroke="currentColor" stroke-width="1" opacity="0.6"/>';
              });
              svg += '<line x1="' + (aggregatorX + 22) + '" y1="' + aggY + '" x2="' + outputX + '" y2="' + aggY + '" stroke="currentColor" stroke-width="2"/>';
              svg += '<text x="' + (outputX + 6) + '" y="' + (aggY + 4) + '" font-size="12" fill="currentColor">F</text>';
              svg += '</svg>';
              resultEl.innerHTML = '<div class="note">' + exprStr + '</div>' + svg;
            }
            function solve() {
              const resultEl = document.getElementById('result');
              const ones = getOnesIndices();
              const total = Math.pow(2, numVars);
              let expr = '';
              let clauses = [];
              let constant = null;
              if (ones.length === 0) {
                constant = 'CONST_0';
              } else if (ones.length === total) {
                constant = 'CONST_1';
              } else if (selectedForm === 'sop') {
                const primes = findPrimeImplicants(ones, numVars);
                const sel = selectPrimeImplicants(primes, ones);
                clauses = sel.map(p => patternToLiterals(p.term, 'sop'));
                expr = sel.map(p => termToExpr(p.term)).join(' + ');
              } else {
                const zeros = getZerosIndices(total);
                if (zeros.length === 0) {
                  constant = 'CONST_1';
                } else if (zeros.length === total) {
                  constant = 'CONST_0';
                } else {
                  const primesZ = findPrimeImplicants(zeros, numVars);
                  const selZ = selectPrimeImplicants(primesZ, zeros);
                  clauses = selZ.map(p => patternToLiterals(p.term, 'pos'));
                  expr = selZ.map(p => literalsToText(patternToLiterals(p.term, 'pos'), 'pos')).join(' · ');
                }
              }
              const label = selectedForm === 'sop' ? 'SOP' : 'POS';
              if (selectedOutput === 'text') {
                if (constant === 'CONST_0') resultEl.textContent = 'Simplified Expression (' + label + '): 0';
                else if (constant === 'CONST_1') resultEl.textContent = 'Simplified Expression (' + label + '): 1';
                else resultEl.textContent = 'Simplified Expression (' + label + '): ' + expr;
              } else if (selectedOutput === 'python') {
                const code = generatePythonCode(constant ? constant : clauses, selectedForm);
                resultEl.innerHTML = '<div class="note">Python pseudocode</div><pre>' + code + '</pre>';
              } else if (selectedOutput === 'gate') {
                const caption = 'Expression (' + label + '): ' + (constant === 'CONST_0' ? '0' : constant === 'CONST_1' ? '1' : expr);
                renderGateDiagram(constant ? constant : clauses, selectedForm, caption);
              }
            }

            document.getElementById('var-count').addEventListener('change', e => {
              numVars = parseInt(e.target.value, 10);
              generateMap();
              solve();
            });
            document.getElementById('form-select').addEventListener('change', e => {
              selectedForm = e.target.value;
              solve();
            });
            document.getElementById('output-select').addEventListener('change', e => {
              selectedOutput = e.target.value;
              solve();
            });

            generateMap();
            solve();
          })();
        </script>
      </div>
    </section>

  </div>
</body>
</html>